import PyPDF2

# Open the existing PDF file
with open('existing_file.pdf', 'rb') as pdf_file:
    # Create a PDF reader object
    pdf_reader = PyPDF2.PdfFileReader(pdf_file)
    # Get the number of pages in the PDF file
    num_pages = pdf_reader.getNumPages()

    # Create a PDF writer object
    pdf_writer = PyPDF2.PdfFileWriter()

    # Iterate through each page in the PDF file
    for page_num in range(num_pages):
        # Add the page to the PDF writer object
        pdf_writer.addPage(pdf_reader.getPage(page_num))

    # Create the bookmarks based on the TOC
    bookmarks = pdf_reader.getOutlines()
    if bookmarks:
        for title, page_num in bookmarks:
            # Add the bookmark to the PDF writer object
            pdf_writer.addBookmark(title, page_num)

    # Save the PDF writer object to a new PDF file
    with open('new_file.pdf', 'wb') as new_pdf_file:
        pdf_writer.write(new_pdf_file)
