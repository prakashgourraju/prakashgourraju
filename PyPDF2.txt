from office365.runtime.auth.authentication_context import AuthenticationContext
from office365.sharepoint.client_context import ClientContext

# SharePoint site URL
site_url = "https://your-site-url.sharepoint.com"

# User credentials
username = "user@your-site-url.onmicrosoft.com"
password = "your-password"

# Authentication context
ctx_auth = AuthenticationContext(site_url)
if ctx_auth.acquire_token_for_user(username, password):
    # Create a ClientContext object for SharePoint site
    ctx = ClientContext(site_url, ctx_auth)

    # Bypass certificate verification
    ctx.request_session.verify = False

    # Your code for making REST API calls goes here
else:
    print(ctx_auth.get_last_error())
