from office365.runtime.auth.user_credential import UserCredential
from office365.sharepoint.client_context import ClientContext
 
# Set the SharePoint site URL
site_url = "https://yoursharepointsite.sharepoint.com/sites/your-site-name"
 
# Set the username and password of the user
username = "user@yourdomain.com"
password = "yourpassword"
 
# Create a UserCredential object with the username and password
credentials = UserCredential(username, password)
 
# Create a ClientContext object with the site URL and the UserCredential object
client_context = ClientContext(site_url).with_credentials(credentials)
 
# Use the ClientContext object to access the SharePoint site
web = client_context.web
client_context.load(web)
client_context.execute_query()
 
# Print the title of the SharePoint site
print("Title: {0}".format(web.properties['Title']))
